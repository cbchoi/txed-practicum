# 학생 실습 모니터링 시스템 인수 테스트

## 테스트 개요

이 문서는 주차별 실습 관리 기능을 포함한 학생 실습 모니터링 시스템의 인수 테스트 시나리오를 정의합니다.

## 테스트 환경

### 사전 요구사항
- Python 3.8+ 설치
- Git 설치
- 인터넷 연결 (GitHub 접근)
- 최소 2GB RAM, 5GB 디스크 공간

### 테스트 데이터
- 테스트 학생 3명 (S20211001, S20211002, S20211003)
- 공개 GitHub 저장소 3개
- 테스트용 채점 스크립트

## 테스트 시나리오

### 1. 시스템 설치 및 초기 설정 테스트

#### 1.1 프로젝트 설정
```bash
# 테스트 절차
1. git clone [프로젝트 저장소]
2. cd txed-practicum
3. pip install -r requirements.txt
```

**예상 결과:**
- ✅ 모든 의존성이 성공적으로 설치됨
- ✅ config.backend.yaml 파일이 존재함
- ✅ weeks 설정이 올바르게 구성됨

#### 1.2 처리 목록 생성
```bash
# 테스트 절차
python generate_process_list.py \
  --roster roster.csv \
  --template "https://github.com/test-org/test-repo-{git_id}" \
  --output process_list.csv
```

**예상 결과:**
- ✅ process_list.csv 파일이 생성됨
- ✅ 올바른 형식 (id,repository_url)으로 생성됨
- ✅ git_id가 템플릿에서 올바르게 치환됨

#### 1.3 부트스트랩 실행
```bash
# 테스트 절차
python bootstrap.py
```

**예상 결과:**
- ✅ students/ 디렉터리 생성됨
- ✅ 각 학생별 하위 디렉터리 생성됨
- ✅ 저장소 클론 시도됨 (성공/실패 상관없음)
- ✅ grading/ 폴더가 각 학생 디렉터리에 복사됨

### 2. 주차별 채점 시스템 테스트

#### 2.1 주차별 채점 스크립트 테스트

**테스트 시나리오:**
1. week1_grader.py 스크립트 생성
2. 학생 디렉터리에 스크립트 배치
3. 채점 실행

```python
# week1_grader.py 테스트 스크립트
#!/usr/bin/env python3
from pathlib import Path

def main():
    # 간단한 테스트: 항상 통과
    Path('week1_pass').write_text('Test passed')

if __name__ == "__main__":
    main()
```

**예상 결과:**
- ✅ week1_grader.py 스크립트가 driver_template.py 대신 실행됨
- ✅ week1_pass 파일이 생성됨
- ✅ 채점 결과가 'pass'로 판정됨

#### 2.2 주차별 결과 파일 관리 테스트

**테스트 시나리오:**
1. 1주차에서 통과 상태 생성
2. 2주차로 변경
3. 2주차에서 실패 상태 생성
4. 다시 1주차로 복귀

**예상 결과:**
- ✅ week1_pass와 week2_fail 파일이 별도로 관리됨
- ✅ 주차 변경 시 해당 주차의 결과만 표시됨
- ✅ 이전 주차 결과가 보존됨

#### 2.3 이전 버전 호환성 테스트

**테스트 시나리오:**
1. 기존 pass/fail 파일 생성
2. 주차별 파일 없이 채점 확인
3. 주차별 파일과 기존 파일 동시 존재 시 우선순위 확인

**예상 결과:**
- ✅ 기존 pass/fail 파일도 인식됨
- ✅ 주차별 파일이 우선순위를 가짐
- ✅ 기존 시스템과의 호환성 유지됨

### 3. 웹 대시보드 주차 기능 테스트

#### 3.1 주차 선택기 테스트

**테스트 절차:**
1. 웹 브라우저에서 http://localhost:8000 접속
2. 헤더의 주차 선택기 확인
3. 다른 주차 선택

**예상 결과:**
- ✅ 주차 선택 드롭다운이 헤더에 표시됨
- ✅ 현재 주차가 선택된 상태로 표시됨
- ✅ 사용 가능한 모든 주차가 옵션으로 표시됨

#### 3.2 주차 변경 기능 테스트

**테스트 절차:**
1. 주차 선택기에서 다른 주차 선택
2. 페이지 새로고침 확인
3. 학생 데이터 변경 확인

**예상 결과:**
- ✅ 주차 변경 시 POST /api/week/{week} 호출됨
- ✅ 페이지가 새로운 주차로 리다이렉션됨
- ✅ 해당 주차의 채점 결과가 표시됨

#### 3.3 실시간 업데이트 테스트

**테스트 절차:**
1. 웹소켓 연결 확인
2. 주차 변경 후 실시간 데이터 업데이트 확인

**예상 결과:**
- ✅ 웹소켓 연결이 정상적으로 설정됨
- ✅ 주차 변경 시 실시간으로 데이터가 업데이트됨
- ✅ 통계 정보가 올바르게 갱신됨

### 4. API 기능 테스트

#### 4.1 주차 관리 API 테스트

```bash
# 현재 주차 정보 조회
curl http://localhost:8000/api/weeks

# 주차 변경
curl -X POST http://localhost:8000/api/week/2

# 잘못된 주차 설정 시도
curl -X POST http://localhost:8000/api/week/99
```

**예상 결과:**
- ✅ GET /api/weeks가 현재 주차와 사용 가능한 주차 반환
- ✅ POST /api/week/{week}가 유효한 주차에 대해 성공 응답
- ✅ 유효하지 않은 주차에 대해 400 에러 반환

#### 4.2 학생 상태 API 테스트

```bash
# 전체 학생 상태 조회
curl http://localhost:8000/api/status

# 특정 학생 상태 조회
curl http://localhost:8000/api/student/S20211001
```

**예상 결과:**
- ✅ 학생 상태에 week 정보가 포함됨
- ✅ 주차별 채점 결과가 올바르게 반영됨
- ✅ 존재하지 않는 학생에 대해 적절한 에러 응답

### 5. 백엔드 스케줄러 테스트

#### 5.1 주차별 채점 실행 테스트

**테스트 절차:**
1. 스케줄러 시작
2. 현재 주차 설정 확인
3. 채점 실행 로그 확인

**예상 결과:**
- ✅ 스케줄러가 현재 주차 설정을 인식함
- ✅ 주차별 채점 스크립트를 우선 실행함
- ✅ 로그에 주차 정보가 포함됨

#### 5.2 주차 변경 시 상태 재초기화 테스트

**테스트 절차:**
1. 현재 주차에서 채점 결과 확인
2. API를 통해 주차 변경
3. 새로운 주차의 채점 결과 확인

**예상 결과:**
- ✅ 주차 변경 시 모든 학생 상태가 새로운 주차로 재초기화됨
- ✅ 이전 주차 결과는 보존됨
- ✅ 새로운 주차의 결과가 정확히 반영됨

### 6. 성능 및 안정성 테스트

#### 6.1 다중 주차 전환 테스트

**테스트 절차:**
1. 빠른 주차 전환 (1→2→3→1→2)
2. 동시 접속 시 주차 전환
3. 메모리 사용량 모니터링

**예상 결과:**
- ✅ 빠른 주차 전환 시에도 안정적으로 동작
- ✅ 메모리 누수 없음
- ✅ 상태 일관성 유지

#### 6.2 대용량 데이터 테스트

**테스트 절차:**
1. 100명 이상의 가상 학생 데이터 생성
2. 여러 주차에 대한 채점 결과 생성
3. 성능 측정

**예상 결과:**
- ✅ 대용량 데이터에서도 2분 이내 업데이트 완료
- ✅ 웹 대시보드 반응성 유지
- ✅ 메모리 사용량 500MB 이하

### 7. 오류 처리 테스트

#### 7.1 잘못된 주차 설정 테스트

**테스트 시나리오:**
- 음수 주차 설정 시도
- 설정 범위를 벗어나는 주차 설정
- 문자열 주차 설정 시도

**예상 결과:**
- ✅ 적절한 에러 메시지 표시
- ✅ 시스템 안정성 유지
- ✅ 이전 상태로 복구

#### 7.2 채점 스크립트 오류 테스트

**테스트 시나리오:**
- 존재하지 않는 주차별 스크립트
- 실행 권한 없는 스크립트
- 무한 루프 스크립트

**예상 결과:**
- ✅ 기본 스크립트로 fallback
- ✅ 타임아웃으로 무한 루프 방지
- ✅ 오류 로그 기록

### 8. 사용자 시나리오 테스트

#### 8.1 교수자 사용 시나리오

**시나리오:**
1. 학기 시작 시 시스템 설정
2. 매주 새로운 실습 주차로 변경
3. 학생별 진행 상황 모니터링
4. 문제 학생 식별 및 대응

**검증 항목:**
- ✅ 설정 과정이 직관적임
- ✅ 주차 변경이 쉽고 빠름
- ✅ 상태 정보가 명확히 표시됨
- ✅ 문제 상황 식별 가능

#### 8.2 관리자 사용 시나리오

**시나리오:**
1. 시스템 상태 모니터링
2. 로그 분석을 통한 문제 진단
3. 성능 최적화
4. 백업 및 복구

**검증 항목:**
- ✅ 시스템 상태가 명확히 표시됨
- ✅ 로그 정보가 충분함
- ✅ 성능 메트릭 제공
- ✅ 데이터 무결성 보장

## 테스트 체크리스트

### 기본 기능
- [ ] 시스템 설치 및 설정
- [ ] 처리 목록 생성
- [ ] 부트스트랩 실행
- [ ] Git 저장소 클론
- [ ] 채점 스크립트 실행

### 주차별 기능
- [ ] 주차별 채점 스크립트 인식
- [ ] 주차별 결과 파일 관리
- [ ] 주차 변경 기능
- [ ] 이전 버전 호환성
- [ ] 상태 재초기화

### 웹 인터페이스
- [ ] 주차 선택기 표시
- [ ] 주차 변경 동작
- [ ] 실시간 업데이트
- [ ] 반응형 디자인
- [ ] 오류 처리

### API 기능
- [ ] 주차 관리 API
- [ ] 학생 상태 API
- [ ] 웹소켓 통신
- [ ] 에러 응답 처리

### 성능 및 안정성
- [ ] 메모리 사용량
- [ ] 응답 시간
- [ ] 동시 접속 처리
- [ ] 오류 복구

### 보안
- [ ] 입력 검증
- [ ] 권한 제어
- [ ] 로그 기록
- [ ] 데이터 무결성

## 테스트 실행 방법

### 1. 자동 테스트 실행
```bash
# 기본 기능 테스트
python -m pytest tests/test_basic.py

# 주차별 기능 테스트
python -m pytest tests/test_weekly.py

# API 테스트
python -m pytest tests/test_api.py
```

### 2. 수동 테스트 실행
```bash
# 시스템 시작
./run.sh

# 웹 브라우저에서 테스트
# http://localhost:8000

# API 테스트
curl http://localhost:8000/api/weeks
```

### 3. 성능 테스트 실행
```bash
# 부하 테스트
python scripts/load_test.py

# 메모리 사용량 모니터링
python scripts/memory_monitor.py
```

## 테스트 결과 문서화

### 테스트 보고서 템플릿
```
테스트 날짜: YYYY-MM-DD
테스트 환경: [OS, Python 버전, 메모리, 디스크]
테스트 실행자: [이름]

[기능별 테스트 결과]
✅ 통과 / ❌ 실패 / ⚠️ 부분 통과

[발견된 이슈]
1. 이슈 설명
   - 재현 방법
   - 예상 결과 vs 실제 결과
   - 심각도 (Critical/High/Medium/Low)

[개선 제안]
1. 제안 내용
   - 배경
   - 기대 효과
   - 구현 복잡도
```

이 인수 테스트를 통해 주차별 실습 관리 기능을 포함한 전체 시스템의 품질과 안정성을 검증할 수 있습니다.